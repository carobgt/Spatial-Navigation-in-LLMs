% for two sided printing
%\documentclass[11pt,a4paper,twoside]{book}
% for one sided printing
\documentclass[11pt,a4paper,oneside]{book}
% A few packages that you might need - I have included all the ones that are needed for this template to work correctly, plus a few more. If you wish to do more with Latex then you may need to import other ones. 
\usepackage{amsmath,amssymb,amsthm,color,enumerate,graphicx,natbib,ifthen,url,array}
% \usepackage{lscape}
% \usepackage{placeins}
% \usepackage{multirow}
% \usepackage{fancyhdr}
% \usepackage{emptypage}
% For printing with binding
%\usepackage[inner=4cm,outer=2cm,top=2.5cm,bottom=3cm]{geometry}
% For pdf or printing without binding
\usepackage[inner=3cm,outer=3cm,top=2.5cm,bottom=3cm]{geometry}
% \usepackage[sc]{titlesec}

%\usepackage[toc,page]{appendix}
%\usepackage[titletoc,title]{appendix}
%\input{FloatSettings} % For things like figures and tables
%\input{BibSettings}   % For bibliographies
% \linespread{1.3} % Commented out due to missing setspace package
% Title Settings
\setcounter{secnumdepth}{3}
\setcounter{tocdepth}{3}
\usepackage{hyperref}
% \usepackage{doi}
\begin{document}
\pagestyle{plain}
\frontmatter
%Create a title page
\begin{titlepage} % Suppresses displaying the page number on the title page and the subsequent page counts as page 1
	\newcommand{\HRule}{\rule{\linewidth}{0.5mm}} % Defines a new command for horizontal lines, change thickness here
	
	\center % Centre everything on the page
	%------------------------------------------------
	%	Headings
	%------------------------------------------------	
	\textsc{\LARGE University College London}\\[1.5cm] % Main heading institution
	
	\textsc{\Large Department of Computer Science}\\[0.5cm] % Major heading department
	
	% \textsc{\large A thesis submitted in partial fulfilment of the requirements for the degree of Master of Science in Artificial Intelligence for Biomedicine and Healthcare, University College London}\\[0.5cm] % Minor heading such as course title	
	%------------------------------------------------
	%	Title
	%------------------------------------------------
	\HRule\\[0.4cm]
	{\huge Cognitive Maps in Language Models: A Mechanistic Analysis of Spatial Planning}\\[0.4cm] % Title of your document
	\HRule\\[1.5cm]
	%------------------------------------------------
	%	Author and Supervisor
	%------------------------------------------------
	{\large\textit{Author}}\\
	Caroline \textsc{Baumgartner} % Your name
	\vfill
	\begin{minipage}{1.0\textwidth}
		\begin{center}
			\large
			\textit{Academic Supervisors}\\
			Dr Neil \textsc{Burgess}\\
			\textsc{Institute of Cognitive Neuroscience}\\
			\textsc{University College London}\\[0.3cm]
			Dr Eleanor \textsc{Spens}\\
			\textsc{Institute of Cognitive Neuroscience}\\
			\textsc{University College London}\\
			\textsc{University of Oxford}\\[0.3cm]
			Dr Petru \textsc{Manescu}\\
			\textsc{Department of Computer Science}\\
			\textsc{University College London}
		\end{center}
	\end{minipage}
	%------------------------------------------------
	%	Date
	%------------------------------------------------	
	\vfill\vfill\vfill % Position the date 3/4 down the remaining page	
	
	{\large\textit\today} % Date, change the \today to a set date if you want to be precise
	
	%------------------------------------------------
	%	Logo
	%------------------------------------------------
       \includegraphics[width=0.2\textwidth]{ucl_logo}\\[1cm] % Include a department/university logo - this will require the graphicx package
	%------------------------------------------------
	%	Disclaimer
	%------------------------------------------------
	
	% Uncomment one of the following statements as appropriate.
	
	 This dissertation is submitted as part requirement for the MSc Artificial Intelligence for Biomedicine and Healthcare degree at UCL. 
     
     %It is substantially the result of my own work except where explicitly 	indicated in the text. 
	 
	 %The dissertation may be freely copied and distributed provided the source is explicitly acknowledged.

	%Or if your project includes information that prevents it from being more widely circulated:
	
	% This dissertation is submitted as part requirement for the MSc ? degree at UCL. It is substantially the result of my own work except where explicitly 	indicated in the text. The dissertation will be distributed to the internal and external examiners, but thereafter may not be copied or distributed except 	with permission from the author.

	%\vfill % Push the date up 1/4 of the remaining page
	
\end{titlepage}
\clearpage 
\newpage 

%\mbox{} % comment this line out for single sided printing
%\newpage % comment this line out for single sided printing
 
% If you wish to dedication your thesis to anyone then you can add this by uncommenting out the following 11 lines
%\section*{Dedications}
%\vspace*{20mm}
%\begin{center}
%\begin{minipage}{0.8\textwidth}
%Dedication
%\end{minipage}
%\end{center}
%\newpage
%\mbox{} % comment this line out for single sided printing
%\newpage % comment this line out for single sided printing

\section*{Abstract}
Large language models exhibit remarkable spatial reasoning capabilities despite being trained only on next-token prediction, raising fundamental questions about how complex cognitive abilities emerge from simple training objectives. This thesis investigates whether transformers learn generalizable "cognitive maps" or develop task-specific spatial heuristics by conducting the first systematic mechanistic analysis of spatial intelligence in neural networks. Through controlled experiments on three GPT-2 Small models trained on different spatial navigation paradigms, we reveal how training objectives fundamentally shape the computational strategies that emerge during learning.

We compare three distinct approaches to spatial learning: (1) the Foraging Model, trained on random walks to simulate passive exploratory learning; (2) the SP-Hamiltonian model, trained on optimal shortest path demonstrations using structured Hamiltonian contexts; and (3) the SP-Random Walk model, fine-tuned from SP-Hamiltonian on unstructured random walks. Using a comprehensive three-part analysis framework—behavioral evaluation, representational analysis, and causal mechanistic interventions—we dissect the internal algorithms underlying spatial reasoning in each model.

Our analysis reveals two fundamentally different computational strategies. The Foraging Model develops a sophisticated three-stage processing pipeline: early directional processing (Layer 1), spatial integration into a self-sufficient coordinate system (Layer 7), and functional refinement into action-oriented representations (Layers 8-12). Crucially, direction ablation experiments demonstrate a sharp phase transition at Layer 7, where the model becomes causally independent of explicit directional information, indicating the emergence of a genuine cognitive map. The model exhibits adaptive computational strategies, switching between local heuristics for minimal context and global reasoning for extended context, achieving robust generalization to larger grids and novel spatial configurations.

In stark contrast, both SP models employ continuous, path-dependent computational strategies that never achieve self-sufficiency. Despite perfect in-distribution performance, the SP-Hamiltonian model fails catastrophically on unstructured data or novel spatial configurations, exhibiting horizontal mirroring patterns that exploit training distribution regularities but break down under generalization. The SP-Random Walk model shows improved robustness through fine-tuning but retains the same path-dependent algorithm, suggesting that representational adaptation does not always translate to algorithmic change.

These findings demonstrate that training objectives function as algorithmic scaffolding, constraining the space of possible computational strategies. Exploratory learning fosters the development of generalizable, allocentric spatial representations akin to cognitive maps, while goal-directed training produces specialized but brittle heuristics optimized for specific task distributions. The work provides the first mechanistic evidence for the cognitive map versus heuristic distinction in artificial neural networks, revealing how the exploration-exploitation trade-off observed in biological systems applies to transformer architectures.

Our results have significant implications for AI development, suggesting that robust spatial intelligence requires balancing optimization pressures with exploratory learning. The mechanistic insights gained through systematic analysis of underlying computational mechanisms provide a framework for understanding how complex capabilities emerge from simple training objectives, advancing our understanding of intelligence in artificial neural networks.
\newpage 
%\mbox{} % comment this out for single sided printing
%\newpage % comment this out for single sided printing
\section*{Acknowledgments}
Write any acknowledgments that you wish to include here e.g.~supervisors/family/etc. You should also include a mention of any grants, sponsorship or other funding that you have received to help you undertake your MSc course.
\newpage
% The table of contents, list of figures and list of tables go here
\setcounter{tocdepth}{2} 
% Setting this higher means you get contents entries for
%  more minor section headers.
\cleardoublepage
\tableofcontents
\cleardoublepage
\listoffigures
\cleardoublepage
\listoftables

% Start the main part of the document here.
\mainmatter

% Include Chapter 1
\input{Chapters/chapter1}

% Include Chapter 2
\input{Chapters/chapter2}

% Include Chapter 3
\input{Chapters/chapter3}

% Include Chapter 4
\input{Chapters/chapter4}

% Include Chapter 5
\input{Chapters/chapter5}

% Include Chapter 6
\input{Chapters/chapter6}

% Include Appendix
\input{Chapters/appendix}

\addcontentsline{toc}{chapter}{Bibliography} % adds a page number for the bibliography to the table of contents

% Actually generates your bibliography.
\bibliographystyle{ormsv080}
\bibliography{MSc_template_tex_examplebib}
\end{document}